module.exports=function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a['default']}:function(){return a};return b.d(c,'a',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p='/',b(b.s=0)}([/*!************************!*\
  !*** multi ./index.js ***!
  \************************//*! dynamic exports provided *//*! all exports used */function(a,b,c){a.exports=c(/*! /Users/mblarsen/workspace/mblarsen/browser-acl/index.js */1)},/*!******************!*\
  !*** ./index.js ***!
  \******************//*! dynamic exports provided *//*! all exports used */function(a,b){'use strict';function c(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(b,'__esModule',{value:!0});var d=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=b.GlobalRule='GLOBAL_RULE',f=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},d=b.strict;c(this,a),this.strict=!1,this.strict=void 0!==d&&d,this.rules=new Map,this.policies=new Map,this.registry=new WeakMap}return d(a,[{key:'rule',value:function(a,b){var c=this,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){return!0};if('function'==typeof b&&''===b.name){var f=[e,b];b=f[0],d=f[1]}var g=this.subjectMapper(b);if(!g)throw new Error('Unable to determine subject name for subject');var h=Array.isArray(a)?a:[a];return h.forEach(function(a){var b=c.rules.get(g)||{};b[a]=d,c.rules.set(g,b)}),this}},{key:'policy',value:function(a,b){var c='function'==typeof a?new a:a,d=this.subjectMapper(b);if(!d)throw new Error('Unable to determine subject name for subject');return this.policies.set(d,c),this}},{key:'register',value:function(a,b){return this.registry.set(a,b),this}},{key:'can',value:function(a,b,c){c='undefined'==typeof c?e:c;var d=this.subjectMapper(c);if(!d)throw new Error('Unable to determine subject name for subject');var f=this.policies.get(d)||this.rules.get(d);if('undefined'==typeof f){if(this.strict)throw new Error('Unknown subject "'+d+'"');return!1}if('function'==typeof f[b]){for(var g=arguments.length,h=Array(3<g?g-3:0),i=3;i<g;i++)h[i-3]=arguments[i];return!!f[b].apply(f,[a,c,d].concat(h))}if(this.strict&&'undefined'==typeof f[b])throw new Error('Unknown verb "'+b+'"');return!!f[b]}},{key:'some',value:function(a,b,c){for(var d=arguments.length,e=Array(3<d?d-3:0),f=3;f<d;f++)e[f-3]=arguments[f];var g=this;return c.some(function(c){return g.can.apply(g,[a,b,c].concat(e))})}},{key:'every',value:function(a,b,c){for(var d=arguments.length,e=Array(3<d?d-3:0),f=3;f<d;f++)e[f-3]=arguments[f];var g=this;return c.every(function(c){return g.can.apply(g,[a,b,c].concat(e))})}},{key:'mixin',value:function(a){var b=this;return a.prototype.can=function(){return b.can.apply(b,[this].concat(Array.prototype.slice.call(arguments)))},a.prototype.can.every=function(){return b.every.apply(b,[this].concat(Array.prototype.slice.call(arguments)))},a.prototype.can.some=function(){return b.some.apply(b,[this].concat(Array.prototype.slice.call(arguments)))},this}},{key:'subjectMapper',value:function(a){return'string'==typeof a?a:'function'==typeof a&&this.registry.has(a)?this.registry.get(a):'function'!=typeof a&&this.registry.has(a.constructor)?this.registry.get(a.constructor):'function'==typeof a?a.name:a.constructor.name}},{key:'reset',value:function(){return this.rules=new Map,this.policies=new Map,this.registry=new WeakMap,this}},{key:'removeRules',value:function(a,b){var c=this.subjectMapper(a);if(c&&this.rules.has(c)){if(b){var d=this.rules.get(c);return d&&delete d[b],this}this.rules.delete(c)}return this}},{key:'removePolicy',value:function(a){var b=this.subjectMapper(a);return b&&this.policies.delete(b),this}},{key:'removeAll',value:function(a){return this.removeRules(a),this.removePolicy(a),this}}]),a}();b.default=f}]);